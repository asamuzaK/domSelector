{
  "version": 3,
  "sources": ["../../../src/js/dom-util.js"],
  "sourcesContent": ["/**\n * dom-util.js\n */\n\n/* import */\nimport bidiFactory from 'bidi-js';\n\n/* constants */\nimport {\n  DOCUMENT_NODE, DOCUMENT_FRAGMENT_NODE, DOCUMENT_POSITION_CONTAINED_BY,\n  ELEMENT_NODE, SYNTAX_ERR\n} from './constant.js';\nconst LTR = 'ltr';\nconst RTL = 'rtl';\n\n/* regexp */\nconst INPUT_TYPE =\n  /^(?:(?:butto|hidde)n|(?:emai|te|ur)l|(?:rese|submi|tex)t|password|search)$/;\nconst SHADOW_MODE = /^(?:close|open)$/;\n\n/* bidi */\nconst bidi = bidiFactory();\n\n/**\n * get slotted text content\n * @param {object} node - Element node\n * @returns {?string} - text content\n */\nexport const getSlottedTextContent = (node = {}) => {\n  let res;\n  if (node.nodeType === ELEMENT_NODE && node.localName === 'slot') {\n    let parent = node.parentNode;\n    let bool;\n    while (parent) {\n      const { host, mode, nodeType, parentNode } = parent;\n      if (nodeType === DOCUMENT_FRAGMENT_NODE && host &&\n          mode && SHADOW_MODE.test(mode)) {\n        bool = true;\n        break;\n      }\n      parent = parentNode;\n    }\n    if (bool) {\n      const nodes = node.assignedNodes();\n      if (nodes.length) {\n        for (const item of nodes) {\n          res = item.textContent.trim();\n          if (res) {\n            break;\n          }\n        }\n      } else {\n        res = node.textContent.trim();\n      }\n    }\n  }\n  return res ?? null;\n};\n\n/**\n * get directionality of node\n * @see https://html.spec.whatwg.org/multipage/dom.html#the-dir-attribute\n * @param {object} node - Element node\n * @returns {?string} - result\n */\nexport const getDirectionality = (node = {}) => {\n  let res;\n  if (node.nodeType === ELEMENT_NODE) {\n    const { dir: nodeDir, localName, parentNode } = node;\n    if (/^(?:ltr|rtl)$/.test(nodeDir)) {\n      res = nodeDir;\n    } else if (nodeDir === 'auto') {\n      let text;\n      if (localName === 'textarea') {\n        text = node.value;\n      } else if (localName === 'input' &&\n                 (!node.type || INPUT_TYPE.test(node.type))) {\n        text = node.value;\n      } else if (localName === 'slot') {\n        text = getSlottedTextContent(node);\n      } else {\n        text = node.textContent.trim();\n      }\n      if (text) {\n        const { paragraphs: [{ level }] } = bidi.getEmbeddingLevels(text);\n        if (level % 2 === 1) {\n          res = RTL;\n        } else {\n          res = LTR;\n        }\n      }\n      if (!res) {\n        if (parentNode) {\n          const { nodeType: parentNodeType } = parentNode;\n          if (parentNodeType === ELEMENT_NODE) {\n            res = getDirectionality(parentNode);\n          } else if (parentNodeType === DOCUMENT_NODE ||\n                     parentNodeType === DOCUMENT_FRAGMENT_NODE) {\n            res = LTR;\n          }\n        } else {\n          res = LTR;\n        }\n      }\n    } else if (localName === 'bdi') {\n      const text = node.textContent.trim();\n      if (text) {\n        const { paragraphs: [{ level }] } = bidi.getEmbeddingLevels(text);\n        if (level % 2 === 1) {\n          res = RTL;\n        } else {\n          res = LTR;\n        }\n      }\n      if (!(res || parentNode)) {\n        res = LTR;\n      }\n    } else if (localName === 'input' && node.type === 'tel') {\n      res = LTR;\n    } else if (parentNode) {\n      if (localName === 'slot') {\n        const text = getSlottedTextContent(node);\n        if (text) {\n          const { paragraphs: [{ level }] } = bidi.getEmbeddingLevels(text);\n          if (level % 2 === 1) {\n            res = RTL;\n          } else {\n            res = LTR;\n          }\n        }\n      }\n      if (!res) {\n        const { nodeType: parentNodeType } = parentNode;\n        if (parentNodeType === ELEMENT_NODE) {\n          res = getDirectionality(parentNode);\n        } else if (parentNodeType === DOCUMENT_NODE ||\n                   parentNodeType === DOCUMENT_FRAGMENT_NODE) {\n          res = LTR;\n        }\n      }\n    } else {\n      res = LTR;\n    }\n  }\n  return res ?? null;\n};\n\n/**\n * is content editable\n * NOTE: not implemented in jsdom https://github.com/jsdom/jsdom/issues/1670\n * @param {object} node - Element node\n * @returns {boolean} - result\n */\nexport const isContentEditable = (node = {}) => {\n  let res;\n  if (node.nodeType === ELEMENT_NODE) {\n    if (typeof node.isContentEditable === 'boolean') {\n      res = node.isContentEditable;\n    } else if (node.ownerDocument.designMode === 'on') {\n      res = true;\n    } else if (node.hasAttribute('contenteditable')) {\n      const attr = node.getAttribute('contenteditable');\n      if (/^(?:plaintext-only|true)$/.test(attr) || attr === '') {\n        res = true;\n      } else if (attr === 'inherit') {\n        let parent = node.parentNode;\n        while (parent) {\n          if (isContentEditable(parent)) {\n            res = true;\n            break;\n          }\n          parent = parent.parentNode;\n        }\n      }\n    }\n  }\n  return !!res;\n};\n\n/**\n * is namespace declared\n * @param {string} ns - namespace\n * @param {object} node - Element node\n * @returns {boolean} - result\n */\nexport const isNamespaceDeclared = (ns = '', node = {}) => {\n  let res;\n  if (ns && typeof ns === 'string' && node.nodeType === ELEMENT_NODE) {\n    const attr = `xmlns:${ns}`;\n    const root = node.ownerDocument.documentElement;\n    let parent = node;\n    while (parent) {\n      if (typeof parent.hasAttribute === 'function' &&\n          parent.hasAttribute(attr)) {\n        res = true;\n        break;\n      } else if (parent === root) {\n        break;\n      }\n      parent = parent.parentNode;\n    }\n  }\n  return !!res;\n};\n\n/**\n * is node same or descendant of the root node\n * @param {object} node - Element node\n * @param {object} root - Document, DocumentFragment, Element node\n * @returns {boolean} - result\n */\nexport const isSameOrDescendant = (node = {}, root = {}) => {\n  let res;\n  if (node.nodeType === ELEMENT_NODE && node.ownerDocument) {\n    if (!root || root.nodeType !== ELEMENT_NODE) {\n      root = node.ownerDocument;\n    }\n    if (node === root) {\n      res = true;\n    } else if (root) {\n      res = root.compareDocumentPosition(node) & DOCUMENT_POSITION_CONTAINED_BY;\n    }\n  }\n  return !!res;\n};\n\n/**\n * selector to node properties - e.g. ns|E -> { prefix: ns, tagName: E }\n * @param {string} selector - type selector\n * @param {object} [node] - Element node\n * @returns {object} - node properties\n */\nexport const selectorToNodeProps = (selector, node) => {\n  let prefix;\n  let tagName;\n  if (selector && typeof selector === 'string') {\n    if (/\\|/.test(selector)) {\n      [prefix, tagName] = selector.split('|');\n    } else {\n      prefix = '*';\n      tagName = selector;\n    }\n  } else {\n    throw new DOMException(`invalid selector ${selector}`, SYNTAX_ERR);\n  }\n  return {\n    prefix,\n    tagName\n  };\n};\n"],
  "mappings": "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",
  "names": ["dom_util_exports", "__export", "getDirectionality", "getSlottedTextContent", "isContentEditable", "isNamespaceDeclared", "isSameOrDescendant", "selectorToNodeProps", "__toCommonJS", "import_bidi_js", "import_constant", "LTR", "RTL", "INPUT_TYPE", "SHADOW_MODE", "bidi", "bidiFactory", "node", "res", "parent", "bool", "host", "mode", "nodeType", "parentNode", "nodes", "item", "nodeDir", "localName", "text", "level", "parentNodeType", "attr", "ns", "root", "selector", "prefix", "tagName"]
}
