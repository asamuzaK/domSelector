var E=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var T=Object.prototype.hasOwnProperty;var m=(n,t)=>{for(var r in t)E(n,r,{get:t[r],enumerable:!0})},y=(n,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of x(t))!T.call(n,s)&&s!==r&&E(n,s,{get:()=>t[s],enumerable:!(i=u(t,s))||i.enumerable});return n};var _=n=>y(E({},"__esModule",{value:!0}),n);var A={};m(A,{generateCSS:()=>O.generate,parseAstName:()=>$,parseSelector:()=>d,preprocess:()=>S,sortAST:()=>L,unescapeSelector:()=>w,walkAST:()=>I});module.exports=_(A);var g=require("css-tree"),e=require("./constant.js"),O=require("css-tree");const w=(n="")=>{if(typeof n=="string"&&n.indexOf("\\",0)>=0){const t=n.split("\\"),r=t.length;for(let i=1;i<r;i++){let s=t[i];if(s===""&&i===r-1)s=e.U_FFFD;else{const p=/^([\da-f]{1,6}\s?)/i.exec(s);if(p){const[,c]=p;let a;try{const o=parseInt("D800",e.HEX),f=parseInt("DFFF",e.HEX),h=parseInt(c,e.HEX);h===0||h>=o&&h<=f?a=e.U_FFFD:a=String.fromCodePoint(h)}catch{a=e.U_FFFD}let l="";s.length>c.length&&(l=s.substring(c.length)),s=`${a}${l}`}else/^[\n\r\f]/.test(s)&&(s="\\"+s)}t[i]=s}n=t.join("")}return n},S=(...n)=>{if(!n.length)throw new TypeError("1 argument required, but only 0 present.");let[t]=n;if(typeof t=="string"){let r=0;for(;r>=0&&(r=t.indexOf("#",r),!(r<0));){const i=t.substring(0,r+1);let s=t.substring(r+1);const p=s.codePointAt(0);if(p===e.BIT_HYPHEN){if(/^\d$/.test(s.substring(1,2)))throw new DOMException(`Invalid selector ${t}`,e.SYNTAX_ERR)}else if(p>e.BIT_FFFF){const c=`\\${p.toString(e.HEX)} `;s.length===e.DUO?s=c:s=`${c}${s.substring(e.DUO)}`}t=`${i}${s}`,r++}t=t.replace(/\f|\r\n?/g,`
`).replace(/[\0\uD800-\uDFFF]|\\$/g,e.U_FFFD)}else if(t==null)t=Object.prototype.toString.call(t).slice(e.TYPE_FROM,e.TYPE_TO).toLowerCase();else if(Array.isArray(t))t=t.join(",");else if(Object.prototype.hasOwnProperty.call(t,"toString"))t=t.toString();else throw new DOMException(`Invalid selector ${t}`,e.SYNTAX_ERR);return t},d=n=>{if(n=S(n),/^$|^\s*>|,\s*$/.test(n))throw new DOMException(`Invalid selector ${n}`,e.SYNTAX_ERR);let t;try{const r=(0,g.parse)(n,{context:"selectorList",parseCustomProperty:!0});t=(0,g.toPlainObject)(r)}catch(r){const i=/(:lang\(\s*("[A-Za-z\d\-*]+")\s*\))/;if(r.message==="Identifier is expected"&&i.test(n)){const[,s,p]=i.exec(n),c=p.replaceAll("*","\\*").replace(/^"/,"").replace(/"$/,""),a=s.replace(p,c);t=d(n.replace(s,a))}else if(r.message==='"]" is expected'&&!n.endsWith("]"))t=d(`${n}]`);else if(r.message==='")" is expected'&&!n.endsWith(")"))t=d(`${n})`);else throw new DOMException(r.message,e.SYNTAX_ERR)}return t},I=(n={})=>{const t=new Set;let r;return(0,g.walk)(n,{enter:s=>{s.type===e.SELECTOR?t.add(s.children):(s.type===e.SELECTOR_PSEUDO_CLASS&&e.REG_LOGICAL_PSEUDO.test(s.name)||s.type===e.SELECTOR_PSEUDO_ELEMENT&&e.REG_SHADOW_PSEUDO.test(s.name))&&(r=!0)}}),r&&(0,g.findAll)(n,(s,p,c)=>{if(c){if(s.type===e.SELECTOR_PSEUDO_CLASS&&e.REG_LOGICAL_PSEUDO.test(s.name)){const a=c.filter(l=>{const{name:o,type:f}=l;return f===e.SELECTOR_PSEUDO_CLASS&&e.REG_LOGICAL_PSEUDO.test(o)});for(const{children:l}of a)for(const{children:o}of l)for(const{children:f}of o)t.has(f)&&t.delete(f)}else if(s.type===e.SELECTOR_PSEUDO_ELEMENT&&e.REG_SHADOW_PSEUDO.test(s.name)){const a=c.filter(l=>{const{name:o,type:f}=l;return f===e.SELECTOR_PSEUDO_ELEMENT&&e.REG_SHADOW_PSEUDO.test(o)});for(const{children:l}of a)for(const{children:o}of l)t.has(o)&&t.delete(o)}}}),[...t]},L=n=>{const t=[...n];if(t.length>1){const r=new Map([[e.SELECTOR_PSEUDO_ELEMENT,e.BIT_01],[e.SELECTOR_ID,e.BIT_02],[e.SELECTOR_CLASS,e.BIT_04],[e.SELECTOR_TYPE,e.BIT_08],[e.SELECTOR_ATTR,e.BIT_16],[e.SELECTOR_PSEUDO_CLASS,e.BIT_32]]);t.sort((i,s)=>{const{type:p}=i,{type:c}=s,a=r.get(p),l=r.get(c);let o;return a===l?o=0:a>l?o=1:o=-1,o})}return t},$=n=>{let t,r;if(n&&typeof n=="string")n.indexOf("|")>-1?[t,r]=n.split("|"):(t="*",r=n);else throw new DOMException(`Invalid selector ${n}`,e.SYNTAX_ERR);return{prefix:t,localName:r}};0&&(module.exports={generateCSS,parseAstName,parseSelector,preprocess,sortAST,unescapeSelector,walkAST});
//# sourceMappingURL=parser.js.map
